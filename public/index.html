
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Inscripciones - Landing</title>
</head>
<body>
    <h1>InscripciÃ³n</h1>
    <input type="email" id="emailInput" placeholder="Ingresa tu correo">
    <button onclick="enviarCodigo()">Enviar CÃ³digo</button>

    <input type="text" id="codigoInput" placeholder="Ingresa el cÃ³digo">
    <button onclick="verificarCodigo()">Verificar CÃ³digo</button>

    <script>
        let codigoVerificacion = null;
        let email = null;

        async function enviarCodigo() {
            email = document.getElementById('emailInput').value;
            if (!email) return alert("Por favor ingresa tu correo");

            const response = await fetch('/api/inscripciones/send-email', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email })
            });

            const result = await response.json();
            if (result.success) {
                codigoVerificacion = result.code;
                alert("CÃ³digo enviado a tu correo.");
                console.log("CÃ³digo recibido:", codigoVerificacion);
            } else {
                alert("Error enviando correo: " + result.message);
            }
        }

        function verificarCodigo() {
            const codigoIngresado = document.getElementById('codigoInput').value.trim();
            console.log("Comparando:", codigoIngresado, "vs", codigoVerificacion);
            if (codigoIngresado === codigoVerificacion) {
                alert("ðŸŽ‰ CÃ³digo correcto. InscripciÃ³n completada.");
                guardarInscripcion();
            } else {
                alert("ðŸš« CÃ³digo incorrecto, intenta otra vez.");
            }
        }

        async function guardarInscripcion() {
            const inscripcion = { email }; 
            const response = await fetch('/api/inscripciones', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(inscripcion)
            });
            const result = await response.json();
            console.log(result);
            if (result.success) {
                alert("âœ… InscripciÃ³n guardada.");
            } else {
                alert("Error guardando inscripciÃ³n.");
            }
        }
    </script>
</body>
</html>
